<!DOCTYPE html>
<html lang="ja">
          /* coded by Gemini */ 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Falling Greetings</title>
    <style>
        /* * CSS: ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾© 
         */
        body {
            margin: 0;
            overflow: hidden; /* ç”»é¢å¤–ã®è¦ç´ ã‚’éš ã™ */
            height: 100vh;
            width: 100vw;
            /* èƒŒæ™¯ç”»åƒã®è¨­å®šã¯JavaScriptã§è¡Œã„ã¾ã™ */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: background-image 1s ease-in-out; /* ç”»åƒåˆ‡ã‚Šæ›¿ãˆæ™‚ã®æ»‘ã‚‰ã‹ã• */
        }

        .konnichiwa-text {
            position: absolute;
            white-space: nowrap;
            /* åˆæœŸä½ç½®ã¯ç”»é¢å¤–ã®ä¸Šéƒ¨ */
            top: -100px; 
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5); /* æ–‡å­—ã®æ®‹åƒï¼ˆå°‘ã—ã¼ã‹ã—ï¼‰ */
            transition: opacity 1s linear; /* é€æ˜åº¦ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ */
            will-change: transform, color, opacity; /* ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š */
            pointer-events: none; /* ãƒã‚¦ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç„¡è¦–ã—ã€ä¸‹ã®è¦ç´ ã«ã‚¯ãƒªãƒƒã‚¯ãŒé€šã‚‹ã‚ˆã†ã« */
        }

        /* è½ä¸‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ  */
        @keyframes fall {
            from {
                transform: translateY(0);
            }
            to {
                /* ç”»é¢ã®é«˜ã•ã«å¿œã˜ã¦èª¿æ•´ã€‚ã“ã“ã§ã¯150vhã§ç”»é¢å¤–ã¾ã§è½ã¨ã™ */
                transform: translateY(150vh); 
            }
        }
    </style>
</head>
<body>
    <script>
        // 
        // JavaScript: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ­ã‚¸ãƒƒã‚¯ 
        //

        // --- 1. è¨­å®šé …ç›® ---
        
        // ğŸš¨ ç”»åƒURLã®å…¥åŠ›ç®‡æ‰€ ğŸš¨
        const BACKGROUND_IMAGES = [
            "https://picsum.photos/1920/1080?random=1", // 1æšç›®ã®ç”»åƒURL
            "https://picsum.photos/1920/1080?random=2"  // 2æšç›®ã®ç”»åƒURL
        ];
        
        const TEXTS = {
            ja: "ã“ã‚“ã«ã¡ã¯",
            en: "Hello",
            fr: "Bonjour",
            es: "Hola",
            de: "Hallo"
        };
        const MIN_SIZE = 20;
        const MAX_SIZE = 80;
        const INTERVAL_MS = 300; // ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆé–“éš” (ãƒŸãƒªç§’)
        const DURATION_S_MIN = 8; // è½ä¸‹é€Ÿåº¦ (ç§’)
        const DURATION_S_MAX = 15;
        const Z_INDEX_START = 1000; // z-indexã®åˆæœŸå€¤
        
        // --- 2. ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•° ---

        /**
         * ä¹±æ•°ç”Ÿæˆï¼ˆæŒ‡å®šç¯„å›²å†…ï¼‰
         * @param {number} min 
         * @param {number} max 
         */
        function getRandom(min, max) {
            return Math.random() * (max - min) + min;
        }

        /**
         * ãƒ©ãƒ³ãƒ€ãƒ ãªHEXã‚«ãƒ©ãƒ¼ã‚’ç”Ÿæˆï¼ˆç·‘è‰²ãŒä¸»ä½“ã§ã¯ãªã„ã‚ˆã†ã«é…æ…®ï¼‰
         * æ˜ã‚‹ã„è‰²ã‚’å„ªå…ˆã—ã€èƒŒæ™¯ã®ç·‘ã¨å¯¾æ¯”ã•ã›ã‚‹
         * @returns {string} HSLã‚«ãƒ©ãƒ¼æ–‡å­—åˆ—
         */
        function getRandomColor(saturation = 80, lightness = 70) {
            const hue = getRandom(0, 360); // ä»»æ„ã®è‰²ç›¸
            return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        }
        
        /**
         * å›è»¢è§’åº¦ã‚’æ±ºå®šã™ã‚‹
         * - 0åº¦: 50%
         * - 90åº¦: 20%
         * - -90åº¦: 10%
         * - ãã®ä»–: 20% (ãƒ©ãƒ³ãƒ€ãƒ )
         * @returns {number} è§’åº¦ï¼ˆdegï¼‰
         */
        function getRotationAngle() {
            const rand = Math.random();
            if (rand < 0.50) {
                return 0; // 50%
            } else if (rand < 0.70) {
                return 90; // 20%
            } else if (rand < 0.80) {
                return -90; // 10%
            } else {
                return getRandom(-180, 180); // æ®‹ã‚Šã®20%ã¯ãƒ©ãƒ³ãƒ€ãƒ 
            }
        }

        // --- 3. èƒŒæ™¯ç”»åƒã®è¨­å®š ---

        function setRandomBackground() {
            const randomIndex = Math.floor(getRandom(0, BACKGROUND_IMAGES.length));
            const selectedImage = BACKGROUND_IMAGES[randomIndex];
            document.body.style.backgroundImage = `url('${selectedImage}')`;
        }

        // æ¥ç¶šæ™‚ã«ä¸€åº¦ã ã‘èƒŒæ™¯ç”»åƒã‚’è¨­å®š
        setRandomBackground();

        // --- 4. ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ ---
        
        let zIndexCounter = Z_INDEX_START;
        const activeTextElements = new Set(); // ç”»é¢ä¸Šã«è¡¨ç¤ºä¸­ã®è¦ç´ ã‚’ç®¡ç†
        const MIN_DISTANCE_PX = 80; // ãƒ†ã‚­ã‚¹ãƒˆé–“ã®æœ€å°è·é›¢ï¼ˆé‡ãªã‚Šé˜²æ­¢ç”¨ï¼‰

        /**
         * æ–°ã—ã„ã€Œã“ã‚“ã«ã¡ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã‚’ç”Ÿæˆã—ã€è½ä¸‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹
         */
        function createKonnichiwa() {
            // ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã‚’ä½œæˆ
            const textElement = document.createElement('div');
            const langKeys = Object.keys(TEXTS);
            const randomLang = langKeys[Math.floor(getRandom(0, langKeys.length))];
            textElement.textContent = TEXTS[randomLang];
            
            // ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®š
            const fontSize = getRandom(MIN_SIZE, MAX_SIZE);
            const rotation = getRotationAngle();
            const duration = getRandom(DURATION_S_MIN, DURATION_S_MAX);
            
            textElement.className = 'konnichiwa-text';
            textElement.style.fontSize = `${fontSize}px`;
            textElement.style.zIndex = zIndexCounter++; // å¾Œã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸã‚‚ã®ã‚’å‰é¢ã«
            
            // è½ä¸‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®š
            textElement.style.animation = `fall ${duration}s linear forwards`;
            textElement.style.transform = `rotate(${rotation}deg)`;
            
            // è½ä¸‹é–‹å§‹Xåº§æ¨™ã‚’æ±ºå®š (é‡ãªã‚Šé˜²æ­¢ãƒ­ã‚¸ãƒƒã‚¯)
            const viewportWidth = window.innerWidth;
            let startX = 0;
            let maxAttempts = 50;

            // Xåº§æ¨™ã‚’æ±ºå®šã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ (é‡ãªã‚Šé˜²æ­¢)
            // æ—¢å­˜ã®è¦ç´ ã¨ä¸­å¿ƒãŒä¸€å®šè·é›¢ä»¥ä¸Šé›¢ã‚Œã‚‹ã‚ˆã†ã«è©¦è¡Œ
            while (maxAttempts-- > 0) {
                // ç”»é¢ã®å¹…ã®ç¯„å›²å†…ã§ãƒ©ãƒ³ãƒ€ãƒ ãªXåº§æ¨™
                startX = getRandom(0, viewportWidth - fontSize); 
                let isOverlapping = false;

                for (const activeElement of activeTextElements) {
                    // è½ä¸‹é–‹å§‹ä½ç½®ã¯Yåº§æ¨™ãŒç”»é¢å¤–ã§åŒã˜ãªã®ã§Xåº§æ¨™ã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯
                    const activeX = parseFloat(activeElement.getAttribute('data-x'));
                    const distance = Math.abs(startX - activeX);
                    
                    // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚‚è€ƒæ…®ã—ã¦é‡ãªã‚Šã‚’åˆ¤å®š
                    const requiredDistance = (fontSize + parseFloat(activeElement.style.fontSize)) / 2 + MIN_DISTANCE_PX;

                    if (distance < requiredDistance) {
                        isOverlapping = true;
                        break;
                    }
                }

                if (!isOverlapping) {
                    break; // é‡ãªã£ã¦ã„ãªã„ä½ç½®ãŒè¦‹ã¤ã‹ã£ãŸ
                }

                if (maxAttempts === 0) {
                   // è©¦è¡Œå›æ•°ã‚’è¶…ãˆãŸå ´åˆã¯ã€ãã®ã¾ã¾é…ç½®ã—ã¦è«¦ã‚ã‚‹ (ç¨€ã«é‡ãªã‚‹å¯èƒ½æ€§ã‚ã‚Š)
                   break;
                }
            }
            
            textElement.style.left = `${startX}px`;
            textElement.setAttribute('data-x', startX); // é‡ãªã‚Šåˆ¤å®šç”¨ã«Xåº§æ¨™ã‚’ä¿å­˜
            
            document.body.appendChild(textElement);
            activeTextElements.add(textElement);

            // é€£ç¶šçš„ãªè‰²ã®å¤‰æ›´
            let colorInterval = setInterval(() => {
                textElement.style.color = getRandomColor();
            }, 500); // 0.5ç§’ã”ã¨ã«è‰²ã‚’å¤‰æ›´

            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã®å‡¦ç† (ç”»é¢å¤–ã«å‡ºãŸ/å¯¿å‘½ãŒå°½ããŸ)
            textElement.addEventListener('animationend', () => {
                // æ®‹åƒã‚’æ®‹ã™ãŸã‚ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«é€æ˜åº¦ã‚’ä¸‹ã’ã¦ã„ã
                clearInterval(colorInterval);
                textElement.style.opacity = '0';
                
                // é€æ˜åº¦ãŒä¸‹ãŒã‚Šåˆ‡ã£ãŸå¾Œã«è¦ç´ ã‚’å®Œå…¨ã«å‰Šé™¤
                setTimeout(() => {
                    textElement.remove();
                    activeTextElements.delete(textElement);
                }, 1000); // 1ç§’å¾Œã«å®Œå…¨ã«å‰Šé™¤
            });
        }
        
        // --- 5. ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ— ---
        
        // å®šæœŸçš„ã«æ–°ã—ã„ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆ
        setInterval(createKonnichiwa, INTERVAL_MS);    
    
    </script>
</body>
</html>
